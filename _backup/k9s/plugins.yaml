plugins:
  taint-node:
    shortCut: Shift-T
    confirm: false
    description: "Taint node with custom or default taint"
    scopes:
      - nodes
    command: bash
    background: false
    args:
      - -c
      - |
        read -p "Enter taint (format key=value:effect, default k9s=true:NoSchedule): " TAINT
        if [ -z "$TAINT" ]; then
          TAINT="k9s=true:NoSchedule"
        fi
        echo "kubectl --context $CONTEXT taint nodes $NAME $TAINT --overwrite=true" >> ~/.k9s/debug.log
        kubectl --context $CONTEXT taint nodes $NAME $TAINT --overwrite=true 2>&1 | tee -a ~/.k9s/debug.log
  untaint-node:
    shortCut: Shift-U
    confirm: false
    description: "Remove taint k9s=true:NoSchedule from node"
    scopes:
      - nodes
    command: bash
    background: false
    args:
      - -c
      - |
        read -p "Enter taint to remove (format key:effect, default k9s=true:NoSchedule): " TAINT
        if [ -z "$TAINT" ]; then
          TAINT="k9s=true:NoSchedule"
        fi
        echo "kubectl --context $CONTEXT taint nodes $NAME $TAINT- --overwrite=true" >> ~/.k9s/debug.log
        kubectl --context $CONTEXT taint nodes $NAME $TAINT- --overwrite=true 2>&1 | tee -a ~/.k9s/debug.log
  evict-pods:
    shortCut: Shift-V
    confirm: true
    description: "Evict pod"
    scopes:
      - pods
    command: bash
    dangerous: true
    background: true
    args:
      - -c
      - |
        echo "kubectl evict-pod --context $CONTEXT $NAME -n $NAMESPACE" >> ~/.k9s/debug.log
        kubectl evict-pod --context $CONTEXT $NAME -n $NAMESPACE 2>&1 | tee -a ~/.k9s/debug.log
  # Manage cert-manager Certificate resouces via cmctl.
  # See: https://github.com/cert-manager/cmctl
  cert-status:
    shortCut: Shift-S
    confirm: false
    description: Certificate status
    scopes:
      - certificates
    command: bash
    background: false
    args:
      - -c
      - "cmctl status certificate --context $CONTEXT -n $NAMESPACE $NAME |& less"
  cert-renew:
    shortCut: Shift-R
    confirm: false
    description: Certificate renew
    scopes:
      - certificates
    command: bash
    background: false
    args:
      - -c
      - "cmctl renew --context $CONTEXT -n $NAMESPACE $NAME |& less"
  secret-inspect:
    shortCut: Shift-I
    confirm: false
    description: Inspect secret
    scopes:
      - secrets
    command: bash
    background: false
    args:
      - -c
      - "cmctl inspect secret --context $CONTEXT -n $NAMESPACE $NAME |& less"
  sync-app:
    shortCut: Shift-S
    confirm: false
    scopes:
      - apps
    description: Sync a argocd app
    command: bash
    background: false
    args:
      - -c
      - "argocd app sync $NAME"
  crd-wizard:
    shortCut: Shift-W
    description: CRD Wizard
    dangerous: false
    scopes:
      - crds
    command: bash
    background: false
    confirm: false
    args:
      - -c
      - "kubectl crd-wizard tui --kind $COL-KIND"
